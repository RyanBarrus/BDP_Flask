CREATE TABLE dbo.IV00101 (
ITEMNMBR VARCHAR(99)
)

CREATE TABLE dbo.RM00101 (
CUSTNMBR VARCHAR(99)
)



CREATE TABLE dbo.SOP10100 (
SOPNUMBE VARCHAR(99),
CUSTNMBR VARCHAR(99),
ReqShipDate DATETIME
)

CREATE TABLE dbo.SOP30200 (
SOPNUMBE VARCHAR(99),
CUSTNMBR VARCHAR(99),
SOPTYPE INT,
VOIDSTTS INT,
ReqShipDate DATETIME
)


CREATE TABLE dbo.SOP10200 (
SOPNUMBE VARCHAR(99),
ITEMNMBR VARCHAR(99),
QUANTITY INT
)

CREATE TABLE dbo.SOP30300 (
SOPNUMBE VARCHAR(99),
ITEMNMBR VARCHAR(99),
QUANTITY INT
)

CREATE TYPE [dbo].[SSCCTable] AS TABLE(
              [SO Number] [varchar](30) NULL,
              [SSCC] [varchar](20) NULL,
              [Item Number] [varchar](35) NULL,
              [Quantity] [varchar](35) NULL,
              [Timestamp] [date] NULL
)
GO

CREATE TABLE [dbo].[a_DistributionCenters](
              [Customer Number] [varchar](50) NULL,
              [Destination Location ID] [varchar](50) NULL,
              [Destination GLN] [varchar](50) NULL
)


CREATE TABLE [dbo].[a_ITEM_WRIN_MAP](
              [ITEMNMBR] [varchar](35) NULL,
              [WRIN] [char](8) NULL,
              [GTIN] [varchar](50) NOT NULL
)




INSERT INTO dbo.IV00101 VALUES
('021-20" STRETCHFILM'),
('021-30MMWRAPPINGPAPER'),
('021-AQUALOPE 355U GREEN INK'),
('021-BD-1001-BL'),
('021-BD-1002-BL'),
('021-BIOADDITIVE'),
('021-BIODEGRADABLE ADDITIVE'),
('021-BMJ STRAW WRAPPING PAPER'),
('021-BOXES'),
('021-BOXES 10.25 BLUE SUPER'),
('021-BOXES 10.25 CLEAR JUMBO'),
('021-BOXES 10.25 HARDEES'),
('021-BOXES 10.25 SHEETZ'),
('021-BOXES 23 5/8X20 1/2X20 1/4'),
('021-BOXES 7.75 BLUE SUPER'),
('021-BOXES 7.75 CLEAR JUMBO'),
('021-BOXES 7.75 HARDEES'),
('021-BOXES 7.75 SHEETZ'),
('021-BOXES 9" BLUE GIANT'),
('021-BOXES AMERCARE'),
('021-BOXES ARBY''S'),
('021-BOXES BD1001'),
('021-BOXES BLANK 200LB'),
('021-BOXES BLANK CHECKERS'),
('021-BOXES DR PEPPER PROMO'),
('021-BOXES FIREHOUSE 7.75'),
('021-BOXES FIREHOUSE 9.5'),
('021-BOXES GO PACK GO'),
('021-BOXES KC CHIEF PROMO'),
('021-BOXES KU MCD PROMO'),
('021-BOXES MCD BACK TO SCHOOL'),
('021-BOXES MCD FREE TUITION'),
('021-BOXES MCD JOIN THE TEAM'),
('021-BOXES PINK PROMO'),
('021-BOXES PORTILLOS'),
('021-BOXES PRINTED CHECKERS'),
('021-BOXES PROMO246'),
('021-BOXES RMHC'),
('021-BOXES SWEET TEA'),
('021-BOXES TEAL STRAW'),
('021-BOXES WENDY''S RED'),
('021-BOXES-BIO STRAW'),
('021-BOXES-CANADA'),
('021-BOXES-CHECKERS STRAWS'),
('021-BOXES-DESPICABLE ME PROMO'),
('021-BOXES-JIB COFFEE STIRRERS'),
('021-BOXES-JIB CORPORATE-STRAW'),
('021-BOXES-JIB FRANCHISE-STRAW'),
('021-BOXES-JIB STRAW BOX'),
('021-BOXES-MCD-STIRRER'),
('021-BOXES-MCD-UPALLNIGHT'),
('021-COLORANT GOLD'),
('021-COLORANT GOLD Y35373'),
('021-COLORANT GREEN E15737'),
('021-COLORANT GREEN E16225'),
('021-COLORANT KC CHIEF RED 186C'),
('021-COLORANT LIQUID BLACK'),
('021-COLORANT LIQUID RALLYS RED'),
('021-COLORANT LIQUID WHITE'),
('021-COLORANT RED #R36764'),
('021-COLORANT RED RALLYS'),
('021-COLORANT TEAL_B27801_302'),
('021-COLORANT-B26301 PURPLE 269'),
('021-COLORANT-BLUE 286'),
('021-COLORANT-BLUE B23899'),
('021-COLORANT-FDA BLACK'),
('021-COLORANT-GREEN E14532-1'),
('021-COLORANT-LIGHT GRAPE'),
('021-COLORANT-PINK 212'),
('021-COLORANT-RED'),
('021-COLORANT-WHITE'),
('021-COLORANT-WHITE-W04200'),
('021-COLORANT-YELLOW'),
('021-FG 10.25 BLUE SPOON STRAW'),
('021-FG 10.25 BLUE SUPER JUMBO'),
('021-FG 10.25 CLEAR JUMBO STRAW'),
('021-FG 12 BLUE GIANT STRAW'),
('021-FG 12 SUPER JUMBO STRAW'),
('021-FG 2PC FORK/KNIFE KIT'),
('021-FG 7.75 BLUE SUPER JUMBO'),
('021-FG 7.75 CLEAR JUMBO STRAW'),
('021-FG 7200 CLEAR BUONA BEEF'),
('021-FG 9" BLUE GIANT STRAW'),
('021-FG 9" SPOON WHITE'),
('021-FG ARBY''S 9.5" RED STRAW'),
('021-FG BIOSTRAW 2000 CLEAR WRP'),
('021-FG BIOSTRAW 2000 GREEN WRP'),
('021-FG BIOSTRAW 2500 CLEAR UNW'),
('021-FG BIOSTRAW 2500 GREEN UNW'),
('021-FG BIOSTRAW 7200 CLEAR WRP'),
('021-FG BIOSTRAW 7200 GREEN'),
('021-FG BIOSTRAW 9000 CLEAR UNW'),
('021-FG BIOSTRAW 9000 GREEN UNW'),
('021-FG BUONA BEEF 7200 CLEAR'),
('021-FG SOUP SPOON'),
('021-FG TEAL AMERCARE STRAW'),
('021-FG-10.25 RED HARDEE STRAW'),
('021-FG-10.25 SHEETZ RED'),
('021-FG-7.75 ORANGE GIANT STRAW'),
('021-FG-7.75 RED HARDEE STRAW'),
('021-FG-7.75 RED STRAW'),
('021-FG-7.75 SHEETZ RED'),
('021-FG-7.75 WHITE W/RED STRAW'),
('021-FG-8.75" PURPLE WRAP STRAW'),
('021-FG-ALASKA_MCD'),
('021-FG-AMC-8.75 RED STRAW'),
('021-FG-BACK TO SCHOOL_MCD'),
('021-FG-BIOSTRAW'),
('021-FG-DEALS ON THE DOWNLOAD'),
('021-FG-DESPICABLEME_MCD'),
('021-FG-HARDEES WHITE 2RS'),
('021-FG-HIRINGDAY_MCD'),
('021-FG-JOINTHETEAM_MCD'),
('021-FG-KC CHIEFS STRAWS'),
('021-FG-MCD-UPALLNIGHT STRAWS'),
('021-FG-MCD-YELLOW STRAW'),
('021-FG-MCDPINKSTRAW'),
('021-FG-MCDSTIRRER'),
('021-FG-NEWSTRAW'),
('021-FG-NUSTRAW'),
('021-FG-RED MILKSHK STRAW 7.75"'),
('021-FG-RED STRAW 10.25" CLEAR'),
('021-FG-RMHC_MCD'),
('021-FG-WENDY''S 9" STRAW'),
('021-FG-WENDY''S 9" STRAW - RED'),
('021-FIREHOUSE 7.75 STRAW'),
('021-FIREHOUSE 9.5 STRAW'),
('021-GLOVES L 07606-021'),
('021-GLOVES M 07605-021'),
('021-GLOVES S 07604-018'),
('021-GLOVES XL 07607-012'),
('021-GLOVES XXL'),
('021-HM10MAXADDITIVE'),
('021-JIB COFFEE STIRRER'),
('021-MCFRAPPEBOX'),
('021-MISC CHARGE'),
('021-MONOPOLY 223-192'),
('021-MONOPOLY 223-261'),
('021-MONOPOLY BOXES'),
('021-OPP FILM'),
('021-OPP FILM 30MM'),
('021-PALLET'),
('021-PMS505 INK'),
('021-POLYBAGS'),
('021-PRINTEDPAPERFILM SUBWAY'),
('021-RED INK AQUALOPE BD 186U'),
('021-REDINK'),
('021-REFLEX BLUE INK'),
('021-REGRIND'),
('021-REPROCESSED RESIN'),
('021-RESIN'),
('021-SLIPSHEET'),
('021-STIRWRAPPAPER'),
('021-STRAWWRAPPINGPAPER'),
('021-WRAPPED DQ STRAWS'),
('021-WRAPPED GO PACK GO'),
('021-WRAPPED SWEET TEA'),
('021-WRAPPEDDR.PEPPERSTRAW2013'),
('021-WRAPPEDEKU'),
('021-WRAPPEDGOBLUE'),
('021-WRAPPEDGREENBAYPACKERS'),
('021-WRAPPEDJIBSTRAWS'),
('021-WRAPPEDJUMBOCSTRAW'),
('021-WRAPPEDJUMBOSTRAWS'),
('021-WRAPPEDJUMBOSTRAWS*'),
('021-WRAPPEDLRGDR.PEPPERSTRAW'),
('021-WRAPPEDMCFRAPPESTRAW'),
('021-WRAPPEDRALLYSTRAW'),
('021-WRAPPEDSIP-SIPGREENSTRAW'),
('021-WRAPPEDSUMMERFEST')


INSERT INTO dbo.a_DistributionCenters VALUES
('020-HAVI GS VA','7',''),
('021-MARTINMASON','24','888632000069'),
('021-MARTINDFW','27','888632000076'),
('020-HAVI GS CT','29',''),
('021-MB ENFIELD','29','888632000090'),
('021-MARTINROCK','37','888632000106'),
('020-PERSECO NY','42',''),
('021-MB HARRIMAN','42','888632000120'),
('020-50PERSECOCT','50',''),
('020-GOLDENSTROC','73',''),
('020-PERSECO PA','81',''),
('020-MB- ST JOHN','82',''),
('021-M&M ST JOHN','82','888632000175'),
('021-KEYSTONE','84','888632000182'),
('020-ANDERSON-LO','88',''),
('020-HAVI GS NC','95',''),
('021-MARTINBROW','98','888632000199'),
('021-TCDISTRIBUT','50','860001061802'),
('021-GOLDENMCCOO','99','888632393475'),
('021-GOLDENSTWI','96','888632473177'),
('041-HUBONE GC','0',''),
('021-GATEWAY','47','888632184592'),
('021-MILEHI','48','853790006505')


INSERT INTO dbo.a_ITEM_WRIN_MAP VALUES
('021-WRAPPEDJUMBOSTRAWS','223058','50195500007132'),
('021-FG-MCDSTIRRER','170095','50195500006920'),
('020-FG-MCD003','193522',''),
('021-FG-RMHC_MCD','223435','50195500007170'),
('021-WRAPPEDJUMBOCSTRAW','223095','50195500030130')

INSERT INTO dbo.RM00101 VALUES
('021-'),
('021-A&C DIST'),
('021-AARGUS'),
('021-AFFY'),
('021-AMERCARE, I'),
('021-ANDERSON-LO'),
('021-BEAVERSHOLD'),
('021-BESTPACKSOL'),
('021-BOOMERS'),
('021-CARVER'),
('021-CDC'),
('021-COFFEE BEAN'),
('021-CONSOLIDATE'),
('021-DALLASDIST'),
('021-DANVILLEDIS'),
('021-DAVIS STAND'),
('021-DEMONDAWGS'),
('021-DQ'),
('021-DQ BROWN'),
('021-DQ PECK'),
('021-DQ TRIFTON'),
('021-DQGLASSCITY'),
('021-DQPFDSUPPL'),
('021-DQPOMPANO '),
('021-DQSHAMROCK'),
('021-DQSYSCOATL'),
('021-DQSYSCOLIN'),
('021-DQSYSCOMN '),
('021-DQTROYERS '),
('021-DQWAUKESHA'),
('021-DREISILKER'),
('021-EARP'),
('021-EASTERN'),
('021-EDWARDDON '),
('021-FISERV'),
('021-FOODPAPER '),
('021-FRESHCOUNTY'),
('021-GARY RAIL'),
('021-GATEWAY'),
('021-GOLDEN ROCH'),
('021-GOLDENMCCOO'),
('021-GOLDENSTATE'),
('021-GOLDENSTCID'),
('021-GOLDENSTPH'),
('021-GOLDENSTWI'),
('021-GOLDSUMNER'),
('021-GRE'),
('021-GRECO & SON'),
('021-GULF GREAT'),
('021-HAPP'),
('021-HAVI'),
('021-HUB1LOGISTI'),
('021-HUBONE-CA '),
('021-HUBONE-GA '),
('021-HUBONE-PA '),
('021-HUBONE-ROME'),
('021-JETSET'),
('021-JIB'),
('021-JONART'),
('021-KANE  '),
('021-KEYSTONE'),
('021-LKWHITE'),
('021-M&M'),
('021-M&M ST JOHN'),
('021-M&M TOLEDO'),
('021-MAINESIL'),
('021-MAINESOH'),
('021-MARTINBC'),
('021-MARTINBROW'),
('021-MARTINBRUN'),
('021-MARTINBWNAS'),
('021-MARTINCALG'),
('021-MARTINDFW '),
('021-MARTINLOUIS'),
('021-MARTINMASON'),
('021-MARTINQUEB'),
('021-MARTINROCK'),
('021-MARTINWEST'),
('021-MARTINWINN'),
('021-MASSDIST'),
('021-MB BRAMPTON'),
('021-MB DICKSON'),
('021-MB ENFIELD'),
('021-MB HARRIMAN'),
('021-MB ROSEMONT'),
('021-MBM MERCED'),
('021-MBMCORP TAY'),
('021-MBSALTLAKE'),
('021-MCLANE FOOD'),
('021-MILEHI'),
('021-NEWHORIZON'),
('021-PBC'),
('021-PECKFOODSER'),
('021-PHOENIXDIST'),
('021-POPS BEEF '),
('021-QUANTUM'),
('021-REINHART'),
('021-SHEETZ'),
('021-SHERMANPLAS'),
('021-SYGMADET'),
('021-TCDISTRIBUT'),
('021-TEAMALLIANC'),
('021-THEPLASTICS'),
('021-TONYS '),
('021-TRIMARK'),
('021-ULFWENDY'),
('021-UNITEDSOURC'),
('021-WINDY')



CREATE TABLE dbo.SOP10100 (
SOPNUMBE VARCHAR(99),
CUSTNMBR VARCHAR(99),
ReqShipDate DATETIME
)


CREATE TABLE dbo.SOP30200 (
SOPNUMBE VARCHAR(99),
CUSTNMBR VARCHAR(99),
SOPTYPE VARCHAR(99),
VOIDSTTS INT,
ReqShipDate DATETIME
)


INSERT INTO dbo.SOP10100 VALUES
('021-SO-00000','021-MARTINMASON',GETDATE()),
('021-SO-00001','021-MARTINMASON',GETDATE()),
('021-SO-00002','021-M&M ST JOHN',GETDATE()),
('021-SO-00003','021-KEYSTONE',GETDATE()),
('021-SO-00004','021-MB HARRIMAN',GETDATE()),
('021-SO-00005','021-KEYSTONE',GETDATE()),
('021-SO-00006','021-MB HARRIMAN',GETDATE())





INSERT INTO dbo.a_ITEM_WRIN_MAP VALUES
('021-WRAPPEDJUMBOSTRAWS','223058','50195500007132'),
('021-FG-MCDSTIRRER','170095','50195500006920'),
('020-FG-MCD003','193522',''),
('021-FG-RMHC_MCD','223435','50195500007170'),
('021-WRAPPEDJUMBOCSTRAW','223095','50195500030130')


INSERT INTO dbo.SOP10200 
SELECT SOPNUMBE, ITEMNMBR, ROW_NUMBER() OVER (ORDER BY SOPNUMBE) * 10 

FROM dbo.SOP10100 

CROSS JOIN 
	(SELECT *

	FROM (VALUES 
	('021-WRAPPEDJUMBOSTRAWS')) AS X(ITEMNMBR)
) x



INSERT INTO dbo.SOP30200 VALUES
('021-IV-00000','021-MARTINMASON',2,0,GETDATE()),
('021-IV-00001','021-MARTINMASON',2,0,GETDATE()),
('021-IV-00002','021-M&M ST JOHN',2,0,GETDATE()),
('021-IV-00003','021-KEYSTONE',2,0,GETDATE()),
('021-IV-00004','021-MB HARRIMAN',2,0,GETDATE()),
('021-IV-00005','021-KEYSTONE',2,0,GETDATE()),
('021-IV-00006','021-MB HARRIMAN',2,0,GETDATE())



INSERT INTO dbo.SOP30300
SELECT SOPNUMBE, ITEMNMBR, ROW_NUMBER() OVER (ORDER BY SOPNUMBE) * 10 

FROM dbo.SOP30200

CROSS JOIN 
	(SELECT *

	FROM (VALUES 
	('021-WRAPPEDJUMBOSTRAWS'),
	('021-FG-MCDSTIRRER')) AS X(ITEMNMBR)
) x


/***************************************************************************
This needs to be added to source
***************************************************************************/
GO
CREATE VIEW dbo.a_PlasticsPotentialASNOrders AS
SELECT RTRIM(a.SOPNUMBE) AS 'SONumber',
'0' AS 'Posted'

FROM dbo.SOP10100 a INNER JOIN dbo.a_DistributionCenters b ON a.CUSTNMBR = b.[Customer Number]

WHERE a.SOPNUMBE like '021%'
AND a.ReqShipDate > DATEADD(m,-1,SYSDATETIME())

UNION ALL

SELECT RTRIM(a.SOPNUMBE)  AS 'SONumber',
'1' AS 'Posted'

FROM dbo.SOP30200 a INNER JOIN dbo.a_DistributionCenters b ON a.CUSTNMBR = b.[Customer Number]

WHERE a.SOPNUMBE like '021%'
AND a.ReqShipDate > DATEADD(year,-1,SYSDATETIME())
AND a.SOPTYPE = 2
AND a.VOIDSTTS = 0
AND a.SOPNUMBE like '021-IV%'
/***************************************************************************/




--BHPRD.dbo.a_Plastics_ASNGenerate




